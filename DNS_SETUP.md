# DNS Records Setup Guide for Fanrae

This guide outlines all the DNS records you need to add to your domain (fanrae.com) for the complete tech stack setup.

## Current Status

You currently have:
- ✅ `@` (root domain) → A record pointing to Squarespace/Vercel IP
- ✅ `www` → CNAME pointing to Vercel DNS

## Required DNS Records

You need to add the following records to your Squarespace DNS settings:

### 1. Supabase Auth Custom Domain (Required)

This enables custom domain authentication (e.g., `auth.fanrae.com` instead of `xxx.supabase.co`).

**Record Type:** CNAME  
**Host:** `auth`  
**Data/Value:** Your Supabase project reference ID (looks like `xxxxx.supabase.co`)  
**TTL:** 30 mins (or default)

**How to get the Supabase domain:**
1. Go to your Supabase project dashboard
2. Navigate to **Authentication** → **URL Configuration**
3. Look for your project reference ID (the part before `.supabase.co`)
4. It should look like: `eyteuevblxvhjhyeivqh.supabase.co`
5. Use just the domain part: `eyteuevblxvhjhyeivqh.supabase.co`

**Example:**
```
HOST: auth
TYPE: CNAME
DATA: eyteuevblxvhjhyeivqh.supabase.co
TTL: 30 mins
```

### 2. Google OAuth Verification (If using custom domain for Google OAuth)

This verifies your domain ownership with Google for OAuth.

**Record Type:** CNAME  
**Host:** `google[randomstring]` (Google will provide this)  
**Data/Value:** `google.com`  
**TTL:** 30 mins

**How to get this:**
1. Go to [Google Cloud Console](https://console.cloud.google.com)
2. Navigate to **APIs & Services** → **Credentials**
3. Find your OAuth 2.0 Client ID
4. Click on **Authorized domains** or **Domain verification**
5. Google will provide a unique CNAME record like: `googleb3edec4f7e35a1`
6. Add this as a CNAME pointing to `google.com`

**Note:** This is optional if you're using Supabase's default auth domain, but required if you want to use a custom domain for Google OAuth.

### 3. ACME Challenge (Auto-generated by Supabase)

After adding the `auth` CNAME record, Supabase will automatically generate SSL certificates. This requires a TXT record for domain verification.

**Record Type:** TXT  
**Host:** `_acme-challenge.auth`  
**Data/Value:** (Generated automatically by Supabase)  
**TTL:** 30 mins

**How to get this:**
1. After adding the `auth` CNAME record, go to Supabase dashboard
2. Navigate to **Authentication** → **URL Configuration**
3. Add custom domain: `auth.fanrae.com`
4. Supabase will provide a TXT record value like: `FI4KsPB5AkndFha93Qzt25YVZXd8tlgpfsvSgy3Ox40`
5. Add this TXT record with host `_acme-challenge.auth`

**Note:** This record is generated automatically when you configure the custom domain in Supabase.

## Complete DNS Records Checklist

Add these records in your Squarespace DNS settings:

| HOST | TYPE | PRIORITY | TTL | DATA |
|------|------|----------|-----|------|
| `@` | A | N/A | 30 mins | `216.150.1.1` (keep existing) |
| `www` | CNAME | N/A | 30 mins | `[your-vercel-dns].vercel-dns-016.com` (keep existing) |
| `auth` | CNAME | N/A | 30 mins | `[your-supabase-id].supabase.co` ⬅️ **ADD THIS** |
| `_acme-challenge.auth` | TXT | N/A | 30 mins | `[supabase-provided-value]` ⬅️ **ADD AFTER #1** |
| `google[xxx]` | CNAME | N/A | 30 mins | `google.com` ⬅️ **OPTIONAL (if needed)** |

## Step-by-Step Setup Process

### Step 1: Add Supabase Auth CNAME
1. Log into Squarespace DNS settings
2. Click **ADD RECORD**
3. Set:
   - **HOST:** `auth`
   - **TYPE:** `CNAME`
   - **DATA:** `[your-supabase-project-id].supabase.co`
   - **TTL:** `30 mins`
4. Save

### Step 2: Update Redirect URLs (Optional but Recommended)
1. While you're in **Authentication** → **URL Configuration**
2. In the **Redirect URLs** section, click **Add URL**
3. Add: `https://auth.fanrae.com/**` (wildcard for all paths)
4. This ensures OAuth callbacks work with your custom domain

### Step 3: Configure Custom Domain in Supabase
1. Go to your [Supabase Dashboard](https://app.supabase.com)
2. Select your project
3. Navigate to: **Project Settings** (gear icon in left sidebar) → **Custom Domains**
   - **Note:** Custom domains require a paid Supabase plan (Pro or above)
   - If you don't see this option, you may need to upgrade
4. Click **Add custom domain** or **Add domain**
5. Enter: `auth.fanrae.com`
6. Supabase will:
   - Check if it can find your CNAME record (may take a few minutes)
   - Display a TXT record value for the ACME challenge
   - Show you the exact value to copy (looks like a long random string)
7. **Copy the TXT record value** - you'll need this for the next step!

### Step 4: Add ACME Challenge TXT Record
1. Copy the TXT record value from Supabase
2. Go back to Squarespace DNS settings
3. Click **ADD RECORD**
4. Set:
   - **HOST:** `_acme-challenge.auth`
   - **TYPE:** `TXT`
   - **DATA:** `[the-value-from-supabase]`
   - **TTL:** `30 mins`
5. Save

### Step 5: Wait for Propagation
- DNS changes can take 5-30 minutes to propagate
- Supabase will verify the domain automatically
- SSL certificate generation takes a few minutes

### Step 6: Verify Setup
1. Check Supabase dashboard for domain verification status
2. Test by visiting: `https://auth.fanrae.com` (should show Supabase auth page)
3. Update your Supabase Auth settings to use the custom domain

## Important Notes

⚠️ **Order Matters:**
1. Add the `auth` CNAME first
2. Wait for it to propagate (5-10 mins)
3. Then configure custom domain in Supabase
4. Then add the ACME challenge TXT record

⚠️ **Google OAuth:**
- If you're using Google OAuth through Supabase, you may need to:
  - Add authorized redirect URIs in Google Cloud Console
  - Use format: `https://auth.fanrae.com/v1/auth/callback/google`
  - Domain verification may be required if Google requests it

⚠️ **TTL Settings:**
- 30 minutes is recommended for faster updates
- Lower TTL = faster changes but slightly more DNS queries

## Troubleshooting

**Issue: Supabase can't find the CNAME record**
- Wait 10-15 minutes for DNS propagation
- Verify the CNAME host is exactly `auth` (no trailing dot)
- Verify the data value is exactly `[id].supabase.co` (no trailing dot)

**Issue: SSL certificate not generating**
- Verify the ACME challenge TXT record is correct
- Wait for DNS propagation (can take up to 30 minutes)
- Check Supabase dashboard for error messages

**Issue: Google OAuth not working**
- Verify redirect URIs in Google Cloud Console
- Ensure you're using the custom domain in redirect URIs
- Check that domain verification is complete if required

## Reference: Your Other Project (eromify.com)

Looking at your eromify.com setup, you have:
- ✅ Google verification CNAME
- ✅ Auth CNAME to Supabase
- ✅ ACME challenge TXT record
- ✅ Root domain A record
- ✅ www CNAME to Vercel

You should replicate a similar setup for fanrae.com.

## Next Steps After DNS Setup

1. ✅ Verify all DNS records are added
2. ✅ Configure custom domain in Supabase
3. ✅ Update Supabase Auth redirect URIs
4. ✅ Update Google OAuth redirect URIs (if applicable)
5. ✅ Test authentication flow with custom domain
6. ✅ Update environment variables if needed

## Resources

- [Supabase Custom Domains](https://supabase.com/docs/guides/auth/auth-helpers/nextjs#custom-domain-setup)
- [Google OAuth Setup](https://developers.google.com/identity/protocols/oauth2)
- [Vercel DNS Documentation](https://vercel.com/docs/concepts/projects/domains)

